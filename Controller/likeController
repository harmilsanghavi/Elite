var bcrypt = require('bcryptjs');
var jwt = require('jsonwebtoken');
const date = require('date-and-time')
var util = require('util')
const conn = require('../connection/connection')
const asyncHandler = require("express-async-handler");

const query = util.promisify(conn.query).bind(conn)

const like = asyncHandler(async (req, res) => {
    var tweetid=req.query.tid;
    console.log(tweetid)
    var id = req.cookies.home;
    var token_id = jwt.verify(id, 'id');
    console.log(token_id)
    var sql=await query(`insert into tweet_like(use_id,twet_id,is_delete) value('${token_id}','${tweetid}',0)`)
    console.log("done")
    res.send({data:"done"})
 })

const dislike = asyncHandler(async (req, res) => {
    var tweetid=req.query.tid;
    console.log(tweetid)
    var id = req.cookies.home;
    var token_id = jwt.verify(id, 'id');
    console.log(token_id)
    // var sql=await query(`insert into tweet_like(use_id,twet_id,is_delete) value('${token_id}','${tweetid}',0)`)
    var sql=await query(`DELETE FROM tweet_like WHERE use_id='${token_id}'`)
    console.log("done2")
    res.send({data:"done2"})
 })

 module.exports={like,dislike}